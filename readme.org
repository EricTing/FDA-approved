* FDA-approved small drug 3D structure dataset

** 1600 FDA-approved small molecule drugs
1. http://www.drugbank.ca/downloads#structures
2. ./dat/approved.txt

** Molecule sizes
*** average heavy atom numbers and standard deviation
**** script
./script/count_atms.py
**** result
./dat/approved_heavy_atom_num.txt
./dat/elements.txt

** DONE 3D structures of the chemicals

*** DONE Drug Bank id to pdb id
CLOSED: [2015-04-22 Wed 12:06]
**** pdb --> uniprt
./dat/pdbsws_chain.txt
**** drug bank id --> uniprt ids
1. ./script/crawler.py
2. ./dat/drugid_uniprturls.dat
**** uniprt id --> pdb id
1. ./script/uniprt_pdb.py
2. ./dat/uniprt_to_pdb.dat
**** drug bank id --> pdb id
1. ./script/query_pdb.py
2. ./dat/drugid_pdb.dat
3. 82773 pdbs
4. 138078 chains

*** DONE Filter the unbound proteins

**** DONE Extract the ligand atoms from the CIF files
CLOSED: [2015-04-26 Sun 11:33] by Michal
1. ./script/qmol_CIF2PDB.pl (not compatible with latest perl modules)
2. /work/jaydy/dat/fda_pdb_mb/

**** TODO Cluster drug ligands
***** TODO 3D Structure
1. ./script/cluster_fingerprints.py
2. sdf --> remove H --> smi (obabel) -->
   obgen -ff <drug>.smi -ff MMF94 --> sdf
3. fails for the below drugs
   | drug id | # heavy atom |
   |---------+--------------|
   | DB08928 |           18 |
   | DB01482 |           26 |
   | DB01294 |           12 |
   | DB06715 |            2 |
   | DB00534 |           11 |
   | DB01377 |            2 |
   | DB00971 |            2 |
   | DB08884 |           40 |
   | DB00995 |           32 |
   | DB00325 |           13 |
   | DB08990 |           30 |
   | DB00789 |           54 |
   | DB05245 |           18 |
   | DB00364 |           78 |
   | DB00538 |           36 |
   | DB00638 |          419 |
   | DB00225 |           31 |
   | DB05630 |           43 |
   | DB01375 |            8 |
   | DB00597 |           29 |
   | DB00200 |           92 |
   | DB00188 |           28 |
   | DB00526 |           15 |
   | DB06705 |           56 |
   | DB01169 |            5 |
   | DB00483 |           39 |
   | DB00115 |           93 |
   | DB00516 |            9 |
   | DB00515 |            5 |
   | DB06703 |           32 |
   | DB08913 |            3 |
   | DB06723 |            4 |
   | DB05260 |           13 |
   | DB05389 |           15 |
   | DB00743 |           63 |
   | DB06402 |          122 |
   | DB00958 |           13 |
4. elements that should not be included
   ./dat/removed_ele.txt
5. remove the unnecessary elements
   ./script/remove_elements.pl
   
   
***** TODO Fingerprints
1. example console command
   MACCSKeysFingerprints.pl --output FP --CompoundID DB00733 DB00733.3d.sdf
2. script
   ./script/fingerprints.py
3. collect the finger prints to one file
   ./script/collect_prints.py
   
***** TODO Cluster based on fingerprints
1. console cmd
   $ cd ~/Workspace/Bitbucket/fda-approved-drugs/dat/
   $ subset -sim 0.9 -log fda_subset.txt < fda_prints.txt > subset_fda_prints.log
2. clustering result
   ./dat/drug_representatives.txt


**** DONE Compare the pdb ligand with drug bank ligand
CLOSED: [2015-04-26 Sun 21:55]
1. calculate tanimoto coefficient using Kcombu
   1. ./script/calculateTanimota.py
   2. pkcombu Segmentation fault for
      1. DB01049
      2. to check
         pkcombu -A /work/jaydy/working/kcombu_run/DB01049_.sdf -B /work/jaydy/dat/_pdb_mb/ib/3ibdA.LG3.pdb
      3. DB00707
2. refuse proteins if their ligand's tanimoto < 0.9
   1. ./script/checkTanimoto.py

*** DONE Cluster the bound proteins based on sequence similarity
CLOSED: [2015-04-27 Mon 17:19]

**** DONE add missing atoms
CLOSED: [2015-04-27 Mon 17:17]
./script/fixPrt.py

**** DONE clean the proteins sequences
CLOSED: [2015-04-27 Mon 11:24]
python ./script/pdb_to_fasta.py > run.sh
sh ./script/run.sh
1. ctrip, heavy atom model
   1. /project/michal/apps/jackal_64bit/bin/ctrip
2. ./script/pdb2pdb.pl
   move pdb sequence to start at 1
3. ./script/pdb2fasta.pl
   convert pdb to fasta
4. ./script/fasta2fasta.pl
   break the lines at 80
**** DONE cd-hit to cluster the sequences
CLOSED: [2015-04-30 Thu 11:40]
1. [X] do not count the prt with seq length > 600
2. cluster
   python ./script/cluster_seq.py > ./script/cluster_seq.sh
   sh ./script/cluster_seq.sh
3. collect
   /home/jaydy/Workspace/Bitbucket/fda-approved-drugs/script/collect.py
4. filter
   1. ./script/filter.py
   2. 188 drugs with 459 complxes
   

**** DONE
1. size of 1554 drugs
   1. script
      ./script/count_atms.py
      ./dat/drug_size.txt
   2. result
      | count | 1554.000000 |
      | mean  |   26.257400 |
      | std   |   18.172654 |
      | min   |    1.000000 |
      | 25%   |   18.000000 |
      | 50%   |   23.000000 |
      | 75%   |   30.000000 |
      | max   |  419.000000 |
   3. one atom drugs
      | DrugBank ID | Chem |
      |-------------+------|
      | DB01356     | Li   |
      | DB01370     | Al   |
      | DB01592     | Fe   |
      | DB01593     | Zn   |
   4. 2 \sigma range
      (0, 62.6)
2. size of filtered drugs
   1. script
      ./script/drug_size.py
   2. result
      | count | 274.000000 |
      | mean  |  24.828467 |
      | std   |  12.933323 |
      | min   |   6.000000 |
      | 25%   |  17.000000 |
      | 50%   |  23.000000 |
      | 75%   |  29.000000 |
      | max   |  93.000000 |
   3. within the 2 \sigma range
      | count | 268.000000 |
      | mean  |  23.559701 |
      | std   |   9.721601 |
      | min   |   6.000000 |
      | 25%   |  17.000000 |
      | 50%   |  22.000000 |
      | 75%   |  29.000000 |
      | max   |  57.000000 |
   4. dat
      ./dat/representative_drugs.csv
   5. human inspection
      1. prepare the datas for rasmol
         ./script/inspect_dat.py


**** TODO
transform the format uisng OpenBabel
1. Ligands
   pdb ---> sdf
2. Proteins
   pdb ---> pdb
